<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.1.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.png">
  <link rel="mask-icon" href="/images/favicon.png" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"yeb-wu.github.io","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":true,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":true,"mediumzoom":false,"lazyload":true,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"manual","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="Java攻城狮">
<meta property="og:type" content="website">
<meta property="og:title" content="yeb-blog">
<meta property="og:url" content="https://yeb-wu.github.io/index.html">
<meta property="og:site_name" content="yeb-blog">
<meta property="og:description" content="Java攻城狮">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="yebin">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://yeb-wu.github.io/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>yeb-blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">yeb-blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">主动才有故事 坚持才有未来</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="reading-progress-bar"></div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://yeb-wu.github.io/posts/0.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="yebin">
      <meta itemprop="description" content="Java攻城狮">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="yeb-blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/posts/0.html" class="post-title-link" itemprop="url">未命名</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2024-04-20 00:34:58 / 修改时间：17:04:43" itemprop="dateCreated datePublished" datetime="2024-04-20T00:34:58+08:00">2024-04-20</time>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>1.9k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>2 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="生成式AI"><a href="#生成式AI" class="headerlink" title="生成式AI"></a>生成式AI</h2><p>在生成式人工智能（Generative AI）中，”生成”一词指的是模型从学习的数据分布中生成新的数据样本或内容。这种生成并不是简单的复制粘贴，而是模型通过对数据的学习和理解，创造出新的、以前未见过的数据。</p>
<p>举个例子，如果是图像生成模型，生成式AI可以创造出看起来像真实照片的新图像，尽管这些图像在现实中并不存在。同样，对于文本生成模型，生成式AI可以创造出类似人类写作风格的文章，甚至可以编写代码或创作音乐。</p>
<p>生成式AI的”生成”是指通过学习数据的分布、结构和模式，在没有直接输入的情况下创造出类似于原始数据的新内容。这种能力使得生成式AI在艺术创作、内容生成、创新设计等领域具有巨大的潜力和应用价值。</p>
<p>生成式对话模型： 这类模型用于生成对话内容，例如聊天机器人。它们可以基于对话历史生成回复，通常使用循环神经网络（RNNs）或变换器（Transformers）等结构。</p>
<h2 id="基础模型-FM-foundation-model"><a href="#基础模型-FM-foundation-model" class="headerlink" title="基础模型(FM, foundation model)"></a>基础模型(FM, foundation model)</h2><p>FM 使用深度神经网络来模拟人脑功能并处理复杂的任务。您可以对 FM 进行调整，以便用于广泛的常规任务，例如文本生成、文本总结、信息提取、图像生成、聊天机器人和问答。FM 还可以作为开发更专门化模型的起点。</p>
<p><img data-src="E:\study\javawebSys\Algorithms-4th-Edition-master\截图\image-20240417104636294-17135445387071.png" alt="image-20240417104636294"></p>
<p>基础模型要经过不同阶段的训练才能达到最佳效果。预训练、微调和提示工程。</p>
<p>FM 可以分为多个类别。最常用的两种模型是文本到文本模型和文本到图像模型。</p>
<p>文本到文本模型是大语言模型 (LLM, large language model)，这种模型经过预训练，用于处理大量文本数据和人类语言。这些大型基础模型可以总结文本、提取信息、回答问题、创建内容（例如博客或产品描述）等。大多数 LLM 都是基于 Transformer 模型的。它们接收输入，对数据进行编码，然后对数据进行解码以产生输出预测。</p>
<p>文本到图像模型接受自然语言输入，并生成与输入文本描述相匹配的高质量图像。文本到图像模型的一些示例包括 OpenAI 推出的 DALL-E 2</p>
<h2 id="提示工程"><a href="#提示工程" class="headerlink" title="提示工程"></a>提示工程</h2><p>提示工程是一个新兴的领域，专注于开发、设计和优化提示，以增强 LLM 的输出，从而满足您的需求。它为您提供了一种引导模型的行为从而达到您想要实现的结果的方法。</p>
<img data-src="https://yeb-1300251269.cos.ap-guangzhou.myqcloud.com/mytypra/PEvsFT%25403x_zh-CN.png" alt="img" style="zoom: 25%;" />

<p>在微调中，使用训练数据调整权重或参数，目标是优化成本函数。</p>
<p>提示工程试图引导经过训练的 FM、LLM 或文本到图像模型给出更相关、更准确的答案。</p>
<h2 id="提示工程的好处"><a href="#提示工程的好处" class="headerlink" title="提示工程的好处"></a>提示工程的好处</h2><p>根据您希望实现的输出的特定上下文来调整 LLM 输出行为</p>
<p>使用领域知识和外部工具增强模型，而无需更改模型参数或进行微调。</p>
<p>通过更高质量的输入获得更高质量的输出。</p>
<h2 id="提示的框架"><a href="#提示的框架" class="headerlink" title="提示的框架"></a>提示的框架</h2><p><strong>指令</strong>：这是大语言模型要执行的任务。它提供模型应如何执行任务的描述或说明。</p>
<p><strong>上下文</strong>：这是用于引导模型的外部信息。</p>
<p><strong>输入数据</strong>：这是需要响应的输入。</p>
<p><strong>输出指示</strong>：这是输出类型或格式。</p>
<p><img data-src="https://yeb-1300251269.cos.ap-guangzhou.myqcloud.com/mytypra/image-20240417110157321.png" alt="image-20240417110157321" style="zoom:50%;" /><img data-src="E:\study\javawebSys\Algorithms-4th-Edition-master\截图\image-20240417110204591-17135445387087.png" alt="image-20240417110204591" style="zoom:50%;" /></p>
<img data-src="E:\study\javawebSys\Algorithms-4th-Edition-master\截图\image-20240417110434021-17135445387089.png" alt="image-20240417110434021" style="zoom:80%;" />



<h2 id="基本提示技术"><a href="#基本提示技术" class="headerlink" title="基本提示技术"></a>基本提示技术</h2><p>零样本提示</p>
<p>零样本提示是这样一种提示技术：用户向 LLM 提出任务，而不给模型提供进一步示例。在这种技术中，用户期望模型在没有事先理解或<em>尝试</em>任务的情况下执行任务。LLM 越大，零样本提示产生有效结果的可能性就越大，现代 LLM 表现出卓越的零样本能力。</p>
<img data-src="E:\study\javawebSys\Algorithms-4th-Edition-master\截图\image-20240417111748202-171354453870811.png" alt="image-20240417111748202" style="zoom: 67%;" />

<p>小样本提示</p>
<p>小样本提示是这样一种提示技术：您为模型提供有关所请求执行的任务的上下文信息。在这种技术中，您同时提供任务和所需输出的示例。在提示条件中提供此上下文或<em>少量样本</em>，可以使模型严格遵循任务指导。</p>
<img data-src="E:\study\javawebSys\Algorithms-4th-Edition-master\截图\image-20240417111801944-171354453870813.png" alt="image-20240417111801944" style="zoom: 67%;" />

<p><strong>思维链提示</strong></p>
<p>思维链 (CoT, chain-of-thought) 提示通过中间推理步骤分解复杂的推理任务。您可以将零样本提示技术和小样本提示技术与 CoT 提示结合使用。 </p>
<p>思维链提示特定于问题类型。您可以使用短语“<strong>一步一步地思考</strong>”在机器学习模型中调用 CoT 推理。</p>
<p><img data-src="https://yeb-1300251269.cos.ap-guangzhou.myqcloud.com/mytypra/image-20240417111957024.png" alt="image-20240417111957024" style="zoom: 50%;" /><img data-src="E:\study\javawebSys\Algorithms-4th-Edition-master\截图\image-20240417112025882-171354453870917.png" alt="image-20240417112025882" style="zoom:50%;" /></p>
<p>高级提示技术</p>
<p>自洽性</p>
<p>自洽性是一种类似于思维链提示的提示技术。然而，自洽性技术不采取明显的一步一步路径或<em>贪婪</em>路径，而是提示模型对各种推理路径进行采样。然后，模型根据来自各个路径的多个数据点聚合最终答案。根据Wang 等人撰写的文章“利用自洽性提高语言模型中的思维链推理效果”(Self-Consistency Improves Chain of Thought Reasoning in Language Models)，当用于一系列常见算术和常识推理基准时，自洽性可以改进 CoT 推理提示。</p>
<p><img data-src="E:\study\javawebSys\Algorithms-4th-Edition-master\截图\image-20240417112812935-171354453870919.png" alt="image-20240417112812935" style="zoom: 50%;" /><img data-src="https://yeb-1300251269.cos.ap-guangzhou.myqcloud.com/mytypra/image-20240417112838303.png" alt="image-20240417112838303" style="zoom:50%;" /></p>
<p>ReAct 提示</p>
<p>ReAct：语言模型中推理和动作的协同作用”(ReAct: Synergizing Reasoning and Acting in Language Models)，模型通常用于推理或动作，但并不总是能同时有效地用于这两者。</p>
<p>借助 ReAct 框架，LLM 可以生成基于外部工具（例如维基百科页面或 SQL 数据库）的推理跟踪和特定于任务的动作。这种外部上下文可产生更准确可靠的输出。</p>
<p><img data-src="https://yeb-1300251269.cos.ap-guangzhou.myqcloud.com/mytypra/image-20240417120255069.png" alt="image-20240417120255069" style="zoom: 40%;" /><img data-src="E:\study\javawebSys\Algorithms-4th-Edition-master\截图\image-20240417120352408-171354453870925.png" alt="image-20240417120352408" style="zoom: 70%;" /></p>
<img data-src="E:\study\javawebSys\Algorithms-4th-Edition-master\截图\image-20240417120644329-171354453871027.png" alt="image-20240417120644329" style="zoom:50%;" />



<h2 id="证书"><a href="#证书" class="headerlink" title="证书"></a>证书</h2><p> <img data-src="E:\study\javawebSys\Algorithms-4th-Edition-master\截图\image-20240420003326013-171354457147142.png" alt="image-20240420003326013"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://yeb-wu.github.io/posts/758e.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="yebin">
      <meta itemprop="description" content="Java攻城狮">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="yeb-blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/posts/758e.html" class="post-title-link" itemprop="url">2024-03-10-博客2.0</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-03-10 14:27:48" itemprop="dateCreated datePublished" datetime="2024-03-10T14:27:48+08:00">2024-03-10</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-04-20 17:51:39" itemprop="dateModified" datetime="2024-04-20T17:51:39+08:00">2024-04-20</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/" itemprop="url" rel="index"><span itemprop="name">项目实战</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>8.8k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>8 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Hexo安装"><a href="#Hexo安装" class="headerlink" title="Hexo安装"></a>Hexo安装</h1><p>参考<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/26625249">https://zhuanlan.zhihu.com/p/26625249</a></p>
<h2 id="1-GitHub创建个人仓库"><a href="#1-GitHub创建个人仓库" class="headerlink" title="1.GitHub创建个人仓库"></a>1.<strong>GitHub创建个人仓库</strong></h2><p><strong>github免密上传</strong></p>
<p>如果不使用免密上传后面上传不了项目</p>
<p><img data-src="https://yeb-1300251269.cos.ap-guangzhou.myqcloud.com/mytypra/image-20240420170126840.png" alt="image-20240420170126840"></p>
<p><strong>创建仓库</strong></p>
<p>名称限制，仓库的名称会决定网站的名称。创建新仓库即可。</p>
<p><strong>启用GitHub Pages</strong></p>
<p>使用GitHub Pages可以部署简单的项目，不需要服务器。</p>
<img data-src="https://yeb-1300251269.cos.ap-guangzhou.myqcloud.com/mytypra/image-20240420165148261.png" alt="image-20240420165148261" style="zoom:80%;" />

<h2 id="2-安装Node-js，安装Hexo"><a href="#2-安装Node-js，安装Hexo" class="headerlink" title="2.安装Node.js，安装Hexo"></a>2.安装Node.js，安装Hexo</h2><p>Hexo是一个快速、简洁且高效的博客框架，让上百个页面在几秒内瞬间完成渲染。<br>安装完Node.js后，就可以使用软件内自带的npm包管理器下载Hexo。<br>在任意文件夹下，右键<code>Git Bash Here</code>，<code>npm install -g hexo-cli</code>安装Hexo，然后使用<code>hexo init hexo-blog</code>初始化一个hexo项目。右键通过Code打开项目，在集成终端打开文件夹，执行<code>hexo server</code>，能够通过localhost:4000访问到项目，hexo就安装成功了。</p>
<p>在 Hexo 中有两份主要的配置文件，其名称都是 _config.yml。 其中，一份位于站点根目录下，主要包含 Hexo 本身的站点配置；另一份位于主题目录下，这份配置由主题作者提供，主要用于配置主题相关的选项。<br>为了描述方便，在以下说明中，将前者称为 站点配置文件， 后者称为 主题配置文件。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/hexo/_config.yml</span><br><span class="line"></span><br><span class="line">/hexo/themes/landscape/_config.yml</span><br></pre></td></tr></table></figure>

<p>打开站点配置文件，修改配置信息：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">deploy:</span><br><span class="line">  type: git</span><br><span class="line">  repository: ssh仓库地址</span><br><span class="line">  branch: master</span><br></pre></td></tr></table></figure>

<p>在repository仓库中填上刚才申请的个人仓库的ssh地址，branch分支填上主分支，保存即可。<br>建议将在VSCode中配置自动保存文件，自行百度进行相关设置。</p>
<p>现在来介绍常用的Hexo 命令</p>
<p>npm install hexo -g #安装Hexo<br>npm update hexo -g #升级<br>hexo init #初始化博客</p>
<p>命令简写<br>hexo n “我的博客” &#x3D;&#x3D; hexo new “我的博客” #新建文章<br>hexo g &#x3D;&#x3D; hexo generate #生成<br>hexo s &#x3D;&#x3D; hexo server #启动服务预览<br>hexo d &#x3D;&#x3D; hexo deploy #部署</p>
<h2 id="3-Hexo项目映射到Github仓库"><a href="#3-Hexo项目映射到Github仓库" class="headerlink" title="3.Hexo项目映射到Github仓库"></a>3.Hexo项目映射到Github仓库</h2><p>完成Hexo配置后，就可以在当前项目的集成终端执行<code>git init</code>，初始化一个git项目。<code>git remote add origin ssh地址</code>，ssh地址即为刚才申请的个人仓库的ssh地址。<br>在使用Hexo部署博客之前，需要先安装一个依赖，这个依赖会将我们生成好的代码部署到一个具体的分支，执行命令<code>npm install hexo-deployer-git</code>安装依赖。然后<code>hexo deploy</code>，即完成Hexo部署到Github。 即为博客通过github page来实现项目的简易部署。</p>
<h2 id="4-Markdown学习与工具"><a href="#4-Markdown学习与工具" class="headerlink" title="4.Markdown学习与工具"></a>4.Markdown学习与工具</h2><p>所有的框架与工具配置好之后，就可以在&#x2F;source&#x2F;_post文件夹里面的.md文件进行博客的编撰，而编撰过程使用Markdown语法进行编写，点击<a target="_blank" rel="noopener" href="https://www.runoob.com/markdown/md-tutorial.html">Markdow</a>学习相应语法，教程比较全面而且讲述清晰，很容易理解。<br>工具使用<a target="_blank" rel="noopener" href="https://typora.io/">Typora</a>，一个轻量级的Markdown文本编辑器，界面极简并且功能强大。</p>
<h1 id="Next主题"><a href="#Next主题" class="headerlink" title="Next主题"></a>Next主题</h1><p>文档：<a target="_blank" rel="noopener" href="https://theme-next.js.org/">https://theme-next.js.org/</a></p>
<h2 id="1、Hexo目录构成"><a href="#1、Hexo目录构成" class="headerlink" title="1、Hexo目录构成"></a>1、Hexo目录构成</h2><blockquote>
<p>node_modules：里面存放Node.js各种库的目录</p>
<p>public：生成网页的文件目录</p>
<p>scaffolds：存放新文章和新页面的初始设置</p>
<p>source：存放文章，各类页面，图像等文件</p>
<p>themes：存放着主题文件</p>
<p>_config.yml：站点配置文件</p>
</blockquote>
<h2 id="2、更换主题"><a href="#2、更换主题" class="headerlink" title="2、更换主题"></a>2、更换主题</h2><p>Hexo有着自己的开源主题库，我们需要去下载Next主题。</p>
<p>在集成终端，也就是博客根目录，执行<code>git clone git@github.com:theme-next/hexo-theme-next.git themes/next</code>，下载完成后，删除next文件夹中的.git和.gitigore文件，因为博客文件夹不能有两个git管理。<br>修改站点配置文件：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">theme: next</span><br></pre></td></tr></table></figure>

<p>执行<code>hexo server</code>，本地的个人博客网站已经更换为Next主题。</p>
<h2 id="3、Next目录构成"><a href="#3、Next目录构成" class="headerlink" title="3、Next目录构成"></a>3、Next目录构成</h2><blockquote>
<p>languages：语言 [通常保存本网站支持的语言设置和支持]</p>
<p>layout：布局文件[通常此文件中添加或者删除一些小功能]</p>
<p>pages：页面文件</p>
<p>scripts：脚本文件 [存放一些JavaScript脚本文件]</p>
<p>sources：资源文件 [存放一些图片,特效之类的文件]</p>
<p><em>config.yml：主题配置文件</em></p>
<p>static_prefix.yml：静态网页参数</p>
</blockquote>
<h2 id="4、设置博主文字描述和中文语言"><a href="#4、设置博主文字描述和中文语言" class="headerlink" title="4、设置博主文字描述和中文语言"></a>4、设置博主文字描述和中文语言</h2><p>站点配置文件修改Site：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># Site</span><br><span class="line">title: </span><br><span class="line">subtitle: </span><br><span class="line">description: </span><br><span class="line">keywords:</span><br><span class="line">author: </span><br><span class="line">language: </span><br><span class="line">timezone: </span><br></pre></td></tr></table></figure>

<h2 id="5、设置Next主题样式"><a href="#5、设置Next主题样式" class="headerlink" title="5、设置Next主题样式"></a>5、设置Next主题样式</h2><p>Next提供了四种主题样式，根据个人的喜好选择即可。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#Schemes</span><br><span class="line">#scheme: Muse</span><br><span class="line">#scheme: Mist</span><br><span class="line">#scheme: Pisces</span><br><span class="line">scheme: Gemini</span><br></pre></td></tr></table></figure>

<h2 id="6、设置博客文章持久化链接"><a href="#6、设置博客文章持久化链接" class="headerlink" title="6、设置博客文章持久化链接"></a>6、设置博客文章持久化链接</h2><p>发布博客后，它的默认url地址是带中文的，并且进行了多层分级，非常复杂，因此需要安装这个插件简化url。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-abbrlink --save</span><br></pre></td></tr></table></figure>

<p>站点配置文件修改permalink添加如下内容：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">url: </span><br><span class="line">permalink: posts/:abbrlink.html</span><br><span class="line">abbrlink:</span><br><span class="line">    alg: crc16</span><br><span class="line">    rep: hex</span><br></pre></td></tr></table></figure>

<h2 id="7、Menu添加关于、标签、分类页面"><a href="#7、Menu添加关于、标签、分类页面" class="headerlink" title="7、Menu添加关于、标签、分类页面"></a>7、Menu添加关于、标签、分类页面</h2><p>站点配置文件修改menu，将about、tags、categories前的#号去掉，示例如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">menu:</span><br><span class="line">  home: / || fa fa-home</span><br><span class="line">  about: /about/ || fa fa-user</span><br><span class="line">  tags: /tags/ || fa fa-tags</span><br><span class="line">  categories: /categories/ || fa fa-th</span><br></pre></td></tr></table></figure>

<p>新建相关页面</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hexo new page &quot;about&quot;</span><br><span class="line">hexo new page &quot;tags&quot;</span><br><span class="line">hexo new page &quot;categories&quot;</span><br></pre></td></tr></table></figure>

<p>修改生成页面的配置<br>source&#x2F;about&#x2F;index.md<br>source&#x2F;tags&#x2F;index.md<br>source&#x2F;categories&#x2F;index.md</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: 关于</span><br><span class="line">type: &quot;about&quot;</span><br><span class="line">---</span><br><span class="line">---</span><br><span class="line">title: 标签</span><br><span class="line">type: &quot;tags&quot;</span><br><span class="line">---</span><br><span class="line">---</span><br><span class="line">title: 分类</span><br><span class="line">type: &quot;categories&quot;</span><br><span class="line">---</span><br></pre></td></tr></table></figure>

<h2 id="8、添加搜索功能"><a href="#8、添加搜索功能" class="headerlink" title="8、添加搜索功能"></a>8、添加搜索功能</h2><p>安装exo-generator-searchdb这个插件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-generator-searchdb --save</span><br></pre></td></tr></table></figure>

<p>站点配置文件添加</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># Search</span><br><span class="line">search:</span><br><span class="line">path: search.xml</span><br><span class="line">field: post</span><br><span class="line">format: html</span><br><span class="line">limit: 10000</span><br></pre></td></tr></table></figure>

<h2 id="9、对于网站样式的自定义"><a href="#9、对于网站样式的自定义" class="headerlink" title="9、对于网站样式的自定义"></a>9、对于网站样式的自定义</h2><p>在博客根目录下的source文件夹下新建_data文件夹并添加styles.styl文件，就可以对网站样式进行自定义<br>以我的个人博客为例，我做了如下自定义样式：修改链接样式、去掉顶部黑线、修改选中字符的颜色、修改代码块选中的颜色、修改引用样式。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">// 修改链接样式</span><br><span class="line">.post-body p a&#123;</span><br><span class="line">  color: #0593d3;</span><br><span class="line">  border-bottom: none;</span><br><span class="line">  &amp;:hover &#123;</span><br><span class="line">    color: #ff106c;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">a, span.exturl &#123;</span><br><span class="line">  border-bottom: none;</span><br><span class="line">  &amp;:hover &#123;</span><br><span class="line">    color: #ff106c;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">  //去掉顶部黑线：</span><br><span class="line">.headband &#123;display:none;&#125;</span><br><span class="line"></span><br><span class="line">// 修改选中字符的颜色</span><br><span class="line">/* webkit, opera, IE9 */</span><br><span class="line">::selection &#123; </span><br><span class="line">    background: #00c4b6;</span><br><span class="line">    color: #f7f7f7; </span><br><span class="line">&#125;</span><br><span class="line">/* firefox */</span><br><span class="line">::-moz-selection &#123; </span><br><span class="line">    background: #00c4b6;</span><br><span class="line">    color: #f7f7f7;    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 代码块选中颜色</span><br><span class="line">.highlight *::selection &#123;</span><br><span class="line">    background: #00c4b6;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//修改引用样式</span><br><span class="line">blockquote &#123;</span><br><span class="line">    border-left: 4px solid #f27c8d;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="10、设置侧栏阅读进度百分比"><a href="#10、设置侧栏阅读进度百分比" class="headerlink" title="10、设置侧栏阅读进度百分比"></a>10、设置侧栏阅读进度百分比</h2><p>编辑站点配置文件，修改 back2top 部分如下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">back2top:</span><br><span class="line">  enable: true</span><br><span class="line">  sidebar: true</span><br><span class="line">  scrollpercent: true</span><br></pre></td></tr></table></figure>

<h2 id="11、设置字数统计和预计阅读时间"><a href="#11、设置字数统计和预计阅读时间" class="headerlink" title="11、设置字数统计和预计阅读时间"></a>11、设置字数统计和预计阅读时间</h2><p>在博客根目录下安装插件：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-symbols-count-time --save</span><br></pre></td></tr></table></figure>

<p>编辑站点配置文件，添加如下内容：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#文章、站点字数统计</span><br><span class="line">symbols_count_time:</span><br><span class="line">  symbols: true                # 文章字数统计</span><br><span class="line">  time: true                   # 文章阅读时长</span><br><span class="line">  total_symbols: true          # 站点总字数统计</span><br><span class="line">  total_time: true             # 站点总阅读时长</span><br><span class="line">  exclude_codeblock: false     # 排除代码字数统计</span><br></pre></td></tr></table></figure>

<p>修改主题配置文件：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">symbols_count_time:</span><br><span class="line">  separated_meta: true     # 是否另起一行（true的话不和发表时间等同一行）</span><br><span class="line">  item_text_post: true     # 首页文章统计数量前是否显示文字描述（本文字数、阅读时长）</span><br><span class="line">  item_text_total: true   # 页面底部统计数量前是否显示文字描述（站点总字数、站点阅读时长）</span><br><span class="line">  awl: 4                   # Average Word Length</span><br><span class="line">  wpm: 275                 # Words Per Minute（每分钟阅读词数）</span><br><span class="line">  suffix: mins.</span><br></pre></td></tr></table></figure>

<h2 id="12、网站底部添加网站运行时间"><a href="#12、网站底部添加网站运行时间" class="headerlink" title="12、网站底部添加网站运行时间"></a>12、网站底部添加网站运行时间</h2><p>修改主题下layout&#x2F;_partials&#x2F;footer.swig，在{ {- next_inject(‘footer’) } }上方添加如下内容：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 网站运行时间的设置 --&gt;</span><br><span class="line">&lt;span id=&quot;timeDate&quot;&gt;载入天数...&lt;/span&gt;</span><br><span class="line">&lt;span id=&quot;times&quot;&gt;载入时分秒...&lt;/span&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">    var now = new Date();</span><br><span class="line">    function createtime() &#123;</span><br><span class="line">        var grt= new Date(&quot;08/10/2021 12:00:00&quot;);//此处修改你的建站时间或者网站上线时间</span><br><span class="line">        now.setTime(now.getTime()+250);</span><br><span class="line">        days = (now - grt ) / 1000 / 60 / 60 / 24; dnum = Math.floor(days);</span><br><span class="line">        hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum); hnum = Math.floor(hours);</span><br><span class="line">        if(String(hnum).length ==1 )&#123;hnum = &quot;0&quot; + hnum;&#125; minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum);</span><br><span class="line">        mnum = Math.floor(minutes); if(String(mnum).length ==1 )&#123;mnum = &quot;0&quot; + mnum;&#125;</span><br><span class="line">        seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum);</span><br><span class="line">        snum = Math.round(seconds); if(String(snum).length ==1 )&#123;snum = &quot;0&quot; + snum;&#125;</span><br><span class="line">        document.getElementById(&quot;timeDate&quot;).innerHTML = &quot;本站已安全运行 &quot;+dnum+&quot; 天 &quot;;</span><br><span class="line">        document.getElementById(&quot;times&quot;).innerHTML = hnum + &quot; 小时 &quot; + mnum + &quot; 分 &quot; + snum + &quot; 秒&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">    setInterval(&quot;createtime()&quot;,250);</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h2 id="13、添加自定义404页面"><a href="#13、添加自定义404页面" class="headerlink" title="13、添加自定义404页面"></a>13、添加自定义404页面</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo new page 404</span><br></pre></td></tr></table></figure>

<p>编辑新建的页面文件，默认在站点根目录下 &#x2F;source&#x2F;404&#x2F;index.md</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: 404</span><br><span class="line">comments: false</span><br><span class="line">permalink: /404</span><br><span class="line">---</span><br><span class="line"></span><br><span class="line">&lt;center&gt;对不起，您所访问的页面不存在或者已删除&lt;/center&gt;</span><br><span class="line"></span><br><span class="line">* [click here](https://yuumiy.github.io/) 返回首页</span><br><span class="line">* 我的Github：[https://github.com/yuumiy](https://github.com/yuumiy)</span><br></pre></td></tr></table></figure>

<h2 id="14、添加图片放大预览功能"><a href="#14、添加图片放大预览功能" class="headerlink" title="14、添加图片放大预览功能"></a>14、添加图片放大预览功能</h2><p>在主题配置文件，启用 fancybox，修改配置如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fancybox: true</span><br></pre></td></tr></table></figure>

<h2 id="15、隐藏网页底部-powered-By-Hexo-强力驱动"><a href="#15、隐藏网页底部-powered-By-Hexo-强力驱动" class="headerlink" title="15、隐藏网页底部 powered By Hexo &#x2F; 强力驱动"></a>15、隐藏网页底部 powered By Hexo &#x2F; 强力驱动</h2><p>修改主题配置文件：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">powered: false</span><br></pre></td></tr></table></figure>

<h2 id="16、网页底部添加动态桃心"><a href="#16、网页底部添加动态桃心" class="headerlink" title="16、网页底部添加动态桃心"></a>16、网页底部添加动态桃心</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">icon:</span><br><span class="line">    animated: true</span><br></pre></td></tr></table></figure>

<h2 id="17、图片懒加载设置"><a href="#17、图片懒加载设置" class="headerlink" title="17、图片懒加载设置"></a>17、图片懒加载设置</h2><p>在主题配置文件中启用lazyload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lazyload: true</span><br></pre></td></tr></table></figure>

<h2 id="18、设置标题栏背景图片"><a href="#18、设置标题栏背景图片" class="headerlink" title="18、设置标题栏背景图片"></a>18、设置标题栏背景图片</h2><p>博客根目录下的source&#x2F;_data&#x2F;styles.styl文件，添加如下代码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// 标题栏背景图片</span><br><span class="line">.site-brand-container &#123; </span><br><span class="line">  background-image: url(/images/bg.png);</span><br><span class="line">  background-size: 100% 100%;</span><br><span class="line">  opacity: 0.9;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>&#x2F;images&#x2F;bg.png指的是根目录下public&#x2F;images&#x2F;下的图片</p>
<h2 id="19、修改文章底部tag标签"><a href="#19、修改文章底部tag标签" class="headerlink" title="19、修改文章底部tag标签"></a>19、修改文章底部tag标签</h2><p>把文章底部#标签改为图标，在主题配置文件中修改：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tag_icon: true</span><br></pre></td></tr></table></figure>

<h2 id="20、设置头像"><a href="#20、设置头像" class="headerlink" title="20、设置头像"></a>20、设置头像</h2><p>在主题配置文件中修改avatar</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># Sidebar Avatar</span><br><span class="line">avatar:</span><br><span class="line">  # Replace the default image and set the url here.</span><br><span class="line">  url: /images/avatar.png</span><br><span class="line">  # If true, the avatar will be dispalyed in circle.</span><br><span class="line">  rounded: true</span><br><span class="line">  # If true, the avatar will be rotated with the cursor.</span><br><span class="line">  rotated: false</span><br></pre></td></tr></table></figure>

<p>&#x2F;images&#x2F;avatar.png指的是根目录下public&#x2F;images&#x2F;下的图片</p>
<h2 id="21、网站底部加上访问量"><a href="#21、网站底部加上访问量" class="headerlink" title="21、网站底部加上访问量"></a>21、网站底部加上访问量</h2><p>修改主题下layout&#x2F;_partials&#x2F;footer.swig，在{ {- next_inject(‘footer’) } }上方添加如下内容：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;script async src=&quot;//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;span&gt;&lt;br&gt;&lt;/span&gt;	</span><br><span class="line"></span><br><span class="line">&lt;span class=&quot;post-meta-item-icon&quot;&gt;</span><br><span class="line">      &lt;i class=&quot;fa fa-user&quot;&gt;&lt;/i&gt;</span><br><span class="line">&lt;/span&gt;</span><br><span class="line">&lt;span&gt;总访客&amp;nbsp&lt;span id=&quot;busuanzi_value_site_uv&quot;&gt;&lt;/span&gt;&amp;nbsp人&lt;/span&gt;</span><br><span class="line">    &lt;span class=&quot;post-meta-divider&quot;&gt;|&lt;/span&gt;</span><br><span class="line">&lt;span class=&quot;post-meta-item-icon&quot;&gt;</span><br><span class="line">      &lt;i class=&quot;fa fa-eye&quot;&gt;&lt;/i&gt;</span><br><span class="line">&lt;/span&gt;</span><br><span class="line">    &lt;span&gt;总访问量&amp;nbsp&lt;span id=&quot;busuanzi_value_site_pv&quot;&gt;&lt;/span&gt;&amp;nbsp次&lt;/span&gt;</span><br></pre></td></tr></table></figure>

<h2 id="22、顶部阅读进度条"><a href="#22、顶部阅读进度条" class="headerlink" title="22、顶部阅读进度条"></a>22、顶部阅读进度条</h2><p>主题配置文件中修改 reading_progress 选项</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">reading_progress:</span><br><span class="line">  enable: true</span><br><span class="line">  # 显示在顶部</span><br><span class="line">  position: top</span><br><span class="line">  color: &quot;#06d633&quot;</span><br><span class="line">  height: 3px</span><br></pre></td></tr></table></figure>

<h2 id="23、设置网站图标"><a href="#23、设置网站图标" class="headerlink" title="23、设置网站图标"></a>23、设置网站图标</h2><p>在主题配置文件中修改favicon</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># 填写自己的图片</span><br><span class="line">favicon:</span><br><span class="line">  small: /images/favicon.png</span><br><span class="line">  medium: /images/favicon.png</span><br><span class="line">  apple_touch_icon: /images/favicon.png</span><br><span class="line">  safari_pinned_tab: /images/favicon.png</span><br></pre></td></tr></table></figure>

<p>&#x2F;images&#x2F;favicon.png指的是根目录下public&#x2F;images&#x2F;下的图片</p>
<h2 id="24、侧边栏社交链接"><a href="#24、侧边栏社交链接" class="headerlink" title="24、侧边栏社交链接"></a>24、侧边栏社交链接</h2><p>修改主题配置文件中socail选项：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">social:</span><br><span class="line">  GitHub: https://github.com/yuumiy || fab fa-github</span><br><span class="line">  E-Mail: mailto:115274737@qq.com || fa fa-envelope</span><br><span class="line">  CSDN: https://blog.csdn.net/qq_44752641 || fab fa-telegram</span><br><span class="line">  RSS: /atom.xml || fas fa-rss</span><br></pre></td></tr></table></figure>

<h2 id="25、阅读全文按钮样式"><a href="#25、阅读全文按钮样式" class="headerlink" title="25、阅读全文按钮样式"></a>25、阅读全文按钮样式</h2><p>在博客需要显示摘要的地方加上 more标签，就不会显示全文。</p>
<h2 id="26、更改新建文章的模板"><a href="#26、更改新建文章的模板" class="headerlink" title="26、更改新建文章的模板"></a>26、更改新建文章的模板</h2><p>默认新建文章没有分类这个选项，需要自己填写，现在修改 hexo&#x2F;scaffolds&#x2F;post.md 文件 。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: &#123;&#123; title &#125;&#125;</span><br><span class="line">date: &#123;&#123; date &#125;&#125;</span><br><span class="line">categories:</span><br><span class="line">tags:</span><br><span class="line">---</span><br></pre></td></tr></table></figure>

<h2 id="27、设定代码高亮格式"><a href="#27、设定代码高亮格式" class="headerlink" title="27、设定代码高亮格式"></a>27、设定代码高亮格式</h2><p>在站点的配置文件中，搜索highlight</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">highlight:</span><br><span class="line">  enable: true</span><br><span class="line">  line_number: true</span><br><span class="line">  auto_detect: true</span><br><span class="line">  tab_replace:</span><br></pre></td></tr></table></figure>

<p>主题配置有关于代码高亮样式的选择，搜索highlight，一般选择normal即可</p>
<h2 id="28、代码块复制选项"><a href="#28、代码块复制选项" class="headerlink" title="28、代码块复制选项"></a>28、代码块复制选项</h2><p>主题配置文件搜索copy_button：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">copy_button:</span><br><span class="line">    enable: true</span><br></pre></td></tr></table></figure>

<h2 id="29、添加萌萌哒Live2D模型"><a href="#29、添加萌萌哒Live2D模型" class="headerlink" title="29、添加萌萌哒Live2D模型"></a>29、添加萌萌哒Live2D模型</h2><p>安装插件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save hexo-helper-live2d</span><br></pre></td></tr></table></figure>

<p>在站点配置文件中添加：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"># live2d</span><br><span class="line">live2d:</span><br><span class="line">  enable: true</span><br><span class="line">  scriptFrom: local</span><br><span class="line">  pluginRootPath: live2dw/</span><br><span class="line">  pluginJsPath: lib/</span><br><span class="line">  pluginModelPath: assets/</span><br><span class="line">  tagMode: false</span><br><span class="line">  debug: false</span><br><span class="line">  model:</span><br><span class="line">    use: live2d-widget-model-hijiki</span><br><span class="line">  display:</span><br><span class="line">    position: right</span><br><span class="line">    width: 150</span><br><span class="line">    height: 300</span><br><span class="line">  mobile:</span><br><span class="line">    show: true</span><br><span class="line">  react:</span><br><span class="line">    opacity: 0.7</span><br></pre></td></tr></table></figure>

<p>喵咪的模型，使用以下命令下载组件，如需使用别的看板娘，请自行百度搜索</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install live2d-widget-model-hijiki</span><br></pre></td></tr></table></figure>

<ul>
<li>在Hexo根目录中新建文件夹live2d_models</li>
<li>在 node_modules 文件夹中找到刚刚下载的 live2d 模型，将其复制到 live2d_models 中。live2d 模型是一个类似于这样的文件夹：live2d-widget-model-hijiki</li>
<li>更新站点配置文件中model.use项，将其修改为 live2d_models 文件夹中的模型文件夹的名称</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://yeb-wu.github.io/posts/bb81.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="yebin">
      <meta itemprop="description" content="Java攻城狮">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="yeb-blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/posts/bb81.html" class="post-title-link" itemprop="url">2023-12-11-ChatGPT</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-12-11 14:28:06" itemprop="dateCreated datePublished" datetime="2023-12-11T14:28:06+08:00">2023-12-11</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-04-20 17:51:13" itemprop="dateModified" datetime="2024-04-20T17:51:13+08:00">2024-04-20</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/" itemprop="url" rel="index"><span itemprop="name">项目实战</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>15k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>14 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="一-chatgpt-sdk项目"><a href="#一-chatgpt-sdk项目" class="headerlink" title="一.chatgpt-sdk项目"></a>一.chatgpt-sdk项目</h1><img data-src="https://yeb-1300251269.cos.ap-guangzhou.myqcloud.com/mytypra/image-20240419233757300.png" alt="image-20240419233757300" style="zoom:80%;" />

<img data-src="https://yeb-1300251269.cos.ap-guangzhou.myqcloud.com/mytypra/image-20240420174216292.png" alt="image-20240420174216292" style="zoom:80%;" />

<h2 id="1-Retrofit2框架介绍"><a href="#1-Retrofit2框架介绍" class="headerlink" title="1.Retrofit2框架介绍"></a>1.Retrofit2框架介绍</h2><p>Retrofit2是一个用于构建基于RESTful API的网络请求的库，它是Square公司开发的一个强大的HTTP客户端库。它提供了简单易用的API，使得开发者可以轻松地进行网络请求的处理。</p>
<p>Retrofit2的主要用途包括：</p>
<ol>
<li>网络请求：Retrofit2可以帮助开发者发送HTTP请求，并处理服务器的响应。它支持多种HTTP请求方法，如GET、POST、PUT、DELETE等，并且可以通过注解的方式来定义请求的URL、请求头、请求体等。</li>
<li>数据解析：Retrofit2支持将服务器返回的JSON、XML等数据格式进行解析，并将其转换为Java对象。它可以使用多种数据解析库，如Gson、Jackson等。</li>
<li>网络请求的封装：Retrofit2可以将网络请求的逻辑进行封装，使得开发者可以通过定义接口的方式来进行网络请求的调用，而无需关心底层的网络请求细节。</li>
<li>网络请求的拦截和增强：Retrofit2支持通过拦截器的方式对网络请求进行拦截和增强，可以在发送请求前或者接收响应后进行一些额外的处理，如添加请求头、打印日志等。</li>
</ol>
<p>Retrofit2底层使用了OkHttp来处理网络请求。OkHttp是Square公司开发的一个高效、可靠的HTTP客户端库，它提供了简单易用的API，支持同步和异步的网络请求，并且具有连接池、请求重试、缓存等功能。</p>
<p>具体的说，使用实现发送http请求，使用okhttp3 的evensourse实现流式传输</p>
<h2 id="2-chatgpt的api"><a href="#2-chatgpt的api" class="headerlink" title="2.chatgpt的api"></a>2.chatgpt的api</h2><p>api key ：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</p>
<img data-src="https://yeb-1300251269.cos.ap-guangzhou.myqcloud.com/mytypra/image-20231212160750072-17135365130033.png" alt="image-20231212160750072" style="zoom:80%;" />

<p>问答模型使用例子</p>
<p><a target="_blank" rel="noopener" href="https://cookbook.openai.com/examples/how_to_format_inputs_to_chatgpt_models">https://cookbook.openai.com/examples/how_to_format_inputs_to_chatgpt_models</a></p>
<p><img data-src="https://yeb-1300251269.cos.ap-guangzhou.myqcloud.com/mytypra/image-20231212162403819.png" alt="image-20231212162403819" style="zoom: 33%;" /><img data-src="https://yeb-1300251269.cos.ap-guangzhou.myqcloud.com/mytypra/image-20231212164114406-17135365130035.png" alt="image-20231212164114406" style="zoom:50%;" /></p>
<p>问答模型api<a target="_blank" rel="noopener" href="https://platform.openai.com/docs/api-reference/chat/create">https://platform.openai.com/docs/api-reference/chat/create</a></p>
<p>QA模型api<a target="_blank" rel="noopener" href="https://platform.openai.com/docs/api-reference/completions/create">https://platform.openai.com/docs/api-reference/completions/create</a></p>
<p>由于chatgpt的api在国内不可用，所以可以使用网上的代理网址，这里推荐一个网站。<a target="_blank" rel="noopener" href="https://api.openai-proxy.com/">https://api.openai-proxy.com</a></p>
<p>注：text-davinci-003模型将在2024年1月过期</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#几个重要参数</span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    model<span class="punctuation">:</span>模型</span><br><span class="line">    message<span class="punctuation">:</span>问答消息</span><br><span class="line">    choice：上下文消息</span><br><span class="line">    token：消耗的token数量，余额</span><br><span class="line">    temperature：对于任何给定的序列，序列中下一个单词的选项都有一个概率分布。设置的温度越接近零，模型越倾向于选择概率较高的单词。设置的温度离零越远，模型可能选择概率较低的单词。创新性。</span><br><span class="line">    Top P：基于潜在选择的概率总和定义截止值。如果设置的 Top P 低于 <span class="number">1.0</span>，模型会考虑概率最高的选项，并忽略概率最低的选项。可选性。</span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="3-https接口对接问题"><a href="#3-https接口对接问题" class="headerlink" title="3.https接口对接问题"></a>3.https接口对接问题</h2><p>跨ssl验证：okhttp生成http请求，但是openai接口需要https请求，这时有两种方法，要么就导入证书，要么就忽略证书验证，这里引入X509TrustManager忽略校验。</p>
<p><img data-src="https://yeb-1300251269.cos.ap-guangzhou.myqcloud.com/mytypra/image-20231225201721654-171353659807210.png" alt="image-20231225201721654"></p>
<h2 id="4-项目启动bug"><a href="#4-项目启动bug" class="headerlink" title="4.项目启动bug"></a>4.项目启动bug</h2><p>注：有时候公众号会出现发消息没反应的情况，可以通过主动回复唤醒，重启一下项目，公众号启动，netapp</p>
<h2 id="5-流式传输"><a href="#5-流式传输" class="headerlink" title="5.流式传输"></a>5.流式传输</h2><p><code>EventSource</code> 是一种用于接收服务器推送事件（Server-Sent Events，SSE）的客户端技术。它是一种基于 HTTP 的轻量级协议，用于从服务器单向推送数据到客户端。<code>EventSource</code> 使得客户端能够实时获取服务器端的更新，而无需进行多余的轮询。</p>
<p>在 Android 中，<code>EventSource</code> 类通常与 OkHttp 库一起使用。OkHttp 是一个流行的 HTTP 客户端库，而 <code>EventSource</code> 则是 OkHttp 的一部分，用于处理 SSE。</p>
<p><code>EventSource</code> 是一种用于接收服务器推送事件（Server-Sent Events，SSE）的客户端技术。它是一种基于 HTTP 的轻量级协议，用于从服务器单向推送数据到客户端。<code>EventSource</code> 使得客户端能够实时获取服务器端的更新，而无需进行多余的轮询。</p>
<p>在 Android 中，<code>EventSource</code> 类通常与 OkHttp 库一起使用。OkHttp 是一个流行的 HTTP 客户端库，而 <code>EventSource</code> 则是 OkHttp 的一部分，用于处理 SSE。</p>
<img data-src="https://yeb-1300251269.cos.ap-guangzhou.myqcloud.com/mytypra/image-20231215224445727-171353718222913.png" alt="image-20231215224445727" style="zoom: 67%;" />

<p><img data-src="https://yeb-1300251269.cos.ap-guangzhou.myqcloud.com/mytypra/image-20231215224506122.png" alt="image-20231215224506122" style="zoom: 60%;" /><img data-src="https://yeb-1300251269.cos.ap-guangzhou.myqcloud.com/mytypra/image-20231215224513369-171353718224017.png" alt="image-20231215224513369" style="zoom:60%;" /></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">okhttp3.sse.EventSource</span><br><span class="line">okhttp3.sse.EventSourceListener</span><br><span class="line"></span><br><span class="line"><span class="title function_">for</span> <span class="params">(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">1</span>; i++)</span> &#123;</span><br><span class="line">            <span class="comment">// 2. 发起请求</span></span><br><span class="line">            <span class="type">EventSource</span> <span class="variable">eventSource</span> <span class="operator">=</span> openAiSession.completions(request, <span class="keyword">new</span> <span class="title class_">EventSourceListener</span>() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onEvent</span><span class="params">(EventSource eventSource, String id, String type, String data)</span> &#123;</span><br><span class="line">                    log.info(<span class="string">&quot;测试结果：&#123;&#125;&quot;</span>, data);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line"><span class="comment">// 等待</span></span><br><span class="line"><span class="keyword">new</span> <span class="title class_">CountDownLatch</span>(<span class="number">1</span>).await();</span><br></pre></td></tr></table></figure>

<p>countdownlatch(1).await()</p>
<p>TEXT_DAVINCI_003模型很不友好，而且快过期了，建议直接使用GPT_3_5_TURBO模型</p>
<p>v1&#x2F;comple接口也没有v1&#x2F;chat&#x2F;complements接口好用</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//流式请求</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> EventSource <span class="title function_">completions</span><span class="params">(QACompletionRequest qaCompletionRequest, EventSourceListener eventSourceListener)</span> <span class="keyword">throws</span> JsonProcessingException &#123;</span><br><span class="line">        <span class="comment">// 核心参数校验；不对用户的传参做更改，只返回错误信息。</span></span><br><span class="line">        <span class="keyword">if</span> (!qaCompletionRequest.isStream())&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;illegal parameter stream is false!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 构建请求信息</span></span><br><span class="line">        <span class="type">Request</span> <span class="variable">request</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Request</span>.Builder()</span><br><span class="line">                .url(configuration.getApiHost().concat(IOpenAiApi.v1_completions))</span><br><span class="line">                .post(RequestBody.create(MediaType.parse(ContentType.JSON.getValue()), <span class="keyword">new</span> <span class="title class_">ObjectMapper</span>().writeValueAsString(qaCompletionRequest)))</span><br><span class="line">                .build();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 返回事件结果</span></span><br><span class="line">        <span class="keyword">return</span> factory.newEventSource(request, eventSourceListener);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">//非流式请求</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> ChatCompletionResponse <span class="title function_">completions</span><span class="params">(ChatCompletionRequest chatCompletionRequest)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.openAiApi.completions(chatCompletionRequest).blockingGet();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>流行请求没有调用Retrofit2的接口，而是使用EventSource（发送请求给chatgpt）+EventSourceListener+ResponseBodyEmitter（返回结果给用户）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">chatGPTOpenAiSession.chatCompletions(chatCompletion, <span class="keyword">new</span> <span class="title class_">EventSourceListener</span>() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onEvent</span><span class="params">(<span class="meta">@NotNull</span> EventSource eventSource, <span class="meta">@Nullable</span> String id, <span class="meta">@Nullable</span> String type, <span class="meta">@NotNull</span> String data)</span> &#123;</span><br><span class="line">                <span class="type">ChatCompletionResponse</span> <span class="variable">chatCompletionResponse</span> <span class="operator">=</span> JSON.parseObject(data, ChatCompletionResponse.class);</span><br><span class="line">                List&lt;ChatChoice&gt; choices = chatCompletionResponse.getChoices();</span><br><span class="line">                <span class="keyword">for</span> (ChatChoice chatChoice : choices) &#123;</span><br><span class="line">                    <span class="type">Message</span> <span class="variable">delta</span> <span class="operator">=</span> chatChoice.getDelta();</span><br><span class="line">                    <span class="keyword">if</span> (Constants.Role.ASSISTANT.getCode().equals(delta.getRole())) <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">                    <span class="comment">// 应答完成</span></span><br><span class="line">                    <span class="type">String</span> <span class="variable">finishReason</span> <span class="operator">=</span> chatChoice.getFinishReason();</span><br><span class="line">                    <span class="keyword">if</span> (StringUtils.isNoneBlank(finishReason) &amp;&amp; <span class="string">&quot;stop&quot;</span>.equals(finishReason)) &#123;</span><br><span class="line">                        emitter.complete();</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="comment">// 发送信息</span></span><br><span class="line">                    <span class="keyword">try</span> &#123;</span><br><span class="line">                        emitter.send(delta.getContent());</span><br><span class="line">                    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">ChatGPTException</span>(e.getMessage());</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br></pre></td></tr></table></figure>

<h2 id="6-Test无法测试输入"><a href="#6-Test无法测试输入" class="headerlink" title="6.@Test无法测试输入"></a>6.@Test无法测试输入</h2><p>如果需要通过控制台实现输入输出，不能用@Test，需要用main函数</p>
<h2 id="7-chatgpt-sdk请求框架"><a href="#7-chatgpt-sdk请求框架" class="headerlink" title="7.chatgpt-sdk请求框架"></a>7.chatgpt-sdk请求框架</h2><img data-src="https://yeb-1300251269.cos.ap-guangzhou.myqcloud.com/mytypra/image-20231216113446092.png" alt="image-20231216113446092" style="zoom: 50%;" />

<img data-src="https://yeb-1300251269.cos.ap-guangzhou.myqcloud.com/mytypra/image-20231216211519625-171353747556822.png" alt="image-20231216211519625" style="zoom:50%;" />

<p>api余额查询</p>
<p><a target="_blank" rel="noopener" href="https://new.bg7iae.com/2023/10/14/sesscheck/">https://new.bg7iae.com/2023/10/14/sesscheck/</a></p>
<p>代理接口的编辑图像接口：这里因为不是直接使用的openai的接口，所以可以上传的文件大小被代理网站限制了。</p>
<h2 id="8-请求封装"><a href="#8-请求封装" class="headerlink" title="8.请求封装"></a>8.请求封装</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@Getter</span></span><br><span class="line"><span class="meta">@Setter</span></span><br><span class="line"><span class="meta">@Builder</span></span><br><span class="line"><span class="meta">@JsonInclude(JsonInclude.Include.NON_NULL)</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">xxxx</span>&#123;</span><br><span class="line">	<span class="meta">@JsonProperty(&quot;top_p&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">Double</span> <span class="variable">topP</span> <span class="operator">=</span> <span class="number">1d</span>;</span><br><span class="line">  	<span class="meta">@NonNull</span></span><br><span class="line">    <span class="keyword">private</span> String prompt;</span><br><span class="line">    <span class="meta">@Builder</span>.Default</span><br><span class="line">    <span class="keyword">private</span> <span class="type">Integer</span> <span class="variable">n</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">    <span class="meta">@Setter</span></span><br><span class="line">    <span class="keyword">private</span> String user;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong><code>@NoArgsConstructor</code> &#x2F; <code>@AllArgsConstructor</code>：</strong> 自动生成无参构造函数和包含所有字段的构造函数。这对于创建对象实例时很方便。</p>
<p><strong><code>@Data</code>：</strong> 是一个组合注解，包含了 <code>@Getter</code>、<code>@Setter</code>、<code>@ToString</code>、<code>@EqualsAndHashCode</code> 和 <code>@RequiredArgsConstructor</code> 的功能。</p>
<p><strong><code>@JsonInclude(JsonInclude.Include.NON_NULL)</code></strong> 在默认情况下，Jackson 会序列化 Java 对象的所有属性，即使它们的值为 <code>null</code>。使用 <code>@JsonInclude(JsonInclude.Include.NON_NULL)</code> 注解后，只有那些值不为 <code>null</code> 的属性才会被包含在 JSON 输出中。</p>
<p><strong><code>@Builder</code>：</strong> 自动生成一个建造者模式的构造器，使得创建对象实例时可以使用流畅的 API。</p>
<h1 id="二-chatgpt-data项目"><a href="#二-chatgpt-data项目" class="headerlink" title="二.chatgpt-data项目"></a>二.chatgpt-data项目</h1><h2 id="1-DDD架构"><a href="#1-DDD架构" class="headerlink" title="1.DDD架构"></a>1.DDD架构</h2><p>DDD 架构常用于微服务场景，因此也一个系统的调用方式就不只是 HTTP 还包括；RPC 远程、MQ 消息、TASK 任务，因此这些种方式都可以理解为触发。<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/464914100">https://zhuanlan.zhihu.com/p/464914100</a></p>
<p>如何区分service和controller的职责</p>
<p>service的接口需要在test中进行测试，他主要负责核心算法的实现</p>
<p>controller主要负责对请求的数据和响应数据进行解析和封装，相当于适配器的角色</p>
<p><img data-src="https://yeb-1300251269.cos.ap-guangzhou.myqcloud.com/mytypra/75&e=1717171199&s=vtvyvvtymvytjty&token=kIxbL07-8jAj8w1n4s9zv64FuZZNEATmlU_Vm6zDXrfaZBJ9-Wz-WB4vGUS2aMkSYvw=-171354069438634.jpg" alt="75&amp;e=1717171199&amp;s=vtvyvvtymvytjty&amp;token=kIxbL07-8jAj8w1n4s9zv64FuZZNEATmlU_Vm6zDXrfaZBJ9-Wz-WB4vGUS2aMkSYvw="></p>
<p><img data-src="https://yeb-1300251269.cos.ap-guangzhou.myqcloud.com/mytypra/image-20240420174701812.png" alt="image-20240420174701812" style="zoom:80%;" /><img data-src="https://yeb-1300251269.cos.ap-guangzhou.myqcloud.com/mytypra/image-20240420174729741.png" alt="image-20240420174729741" style="zoom:50%;" /></p>
<p><img data-src="https://yeb-1300251269.cos.ap-guangzhou.myqcloud.com/mytypra/image-20240420174854928.png" alt="image-20240420174854928" style="zoom:50%;" /><img data-src="https://yeb-1300251269.cos.ap-guangzhou.myqcloud.com/mytypra/image-20240420174952254.png" alt="image-20240420174952254" style="zoom:50%;" /><img data-src="https://yeb-1300251269.cos.ap-guangzhou.myqcloud.com/mytypra/image-20240420175017494.png" alt="image-20240420175017494" style="zoom:50%;" /></p>
<img data-src="https://yeb-1300251269.cos.ap-guangzhou.myqcloud.com/mytypra/image-20240420175043078.png" alt="image-20240420175043078" style="zoom:80%;" />

<h2 id="2-ResponseBodyEmitter"><a href="#2-ResponseBodyEmitter" class="headerlink" title="2.ResponseBodyEmitter"></a>2.ResponseBodyEmitter</h2><p>使用了 ResponseBodyEmitter 做了接口的异步响应，可以把 ChatGPT 返回的接口信息，读取到数据以后，通过 <a target="_blank" rel="noopener" href="http://emitter.send/">emitter.send</a>(delta.getContent()); 响应回去即可。</p>
<p>ResponseBodyEmitter是Spring框架中的一个类，用于实现服务器端的异步响应。它允许你将数据以流的形式发送给客户端，而不需要等待所有数据都准备好后再一次性发送。</p>
<p>ResponseBodyEmitter的主要用途是在长时间运行的操作中实时向客户端发送数据。例如，当你需要处理大量数据或者需要进行复杂的计算时，你可以使用ResponseBodyEmitter来实时地将处理结果发送给客户端，而不需要等待整个操作完成。</p>
<p>使用ResponseBodyEmitter，你可以通过调用<code>send()</code>方法来发送数据，可以是单个对象、集合或者流。你还可以使用<code>complete()</code>方法来标记响应的结束。</p>
<p>在Spring Boot中，你可以将ResponseBodyEmitter作为方法的返回类型，然后在方法体中使用它来发送数据。当客户端发起请求时，服务器会立即返回一个响应，并在后台异步地发送数据。</p>
<p>总结来说，ResponseBodyEmitter在Spring Boot中的用处是实现服务器端的异步响应，允许你实时地向客户端发送数据，特别适用于处理大量数据或者长时间运行的操作。</p>
<p>要使用ResponseBodyEmitter，你需要按照以下步骤进行操作：</p>
<ol>
<li>在你的控制器方法中，将ResponseBodyEmitter作为方法的返回类型。例如：</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;/data&quot;)</span></span><br><span class="line"><span class="keyword">public</span> ResponseBodyEmitter <span class="title function_">getData</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// 创建一个ResponseBodyEmitter对象</span></span><br><span class="line">    <span class="type">ResponseBodyEmitter</span> <span class="variable">emitter</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ResponseBodyEmitter</span>();</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 在后台线程中发送数据</span></span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Thread</span>(() -&gt; &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 发送数据</span></span><br><span class="line">            emitter.send(<span class="string">&quot;Data 1&quot;</span>);</span><br><span class="line">            emitter.send(<span class="string">&quot;Data 2&quot;</span>);</span><br><span class="line">            emitter.send(<span class="string">&quot;Data 3&quot;</span>);</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 标记响应的结束</span></span><br><span class="line">            emitter.complete();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            <span class="comment">// 处理异常</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;).start();</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> emitter;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li><p>在后台线程中使用ResponseBodyEmitter的<code>send()</code>方法来发送数据。你可以发送单个对象、集合或者流。</p>
</li>
<li><p>使用ResponseBodyEmitter的<code>complete()</code>方法来标记响应的结束。</p>
</li>
<li><p>当客户端发起请求时，服务器会立即返回一个响应，并在后台线程中异步地发送数据。</p>
</li>
</ol>
<p>注意事项：</p>
<ul>
<li>你可以在控制器方法中使用@ResponseBody注解来将ResponseBodyEmitter转换为响应体。</li>
<li>如果你需要在发送数据时进行异常处理，可以使用try-catch块来捕获IOException。</li>
<li>如果你需要在发送数据时进行错误处理，可以使用<code>sendError()</code>方法来发送错误信息。</li>
</ul>
<p>这就是使用ResponseBodyEmitter的基本步骤。你可以根据自己的需求来发送不同类型的数据，并在后台线程中进行复杂的计算或处理。</p>
<h2 id="3-其他重要的spring注解"><a href="#3-其他重要的spring注解" class="headerlink" title="3.其他重要的spring注解"></a>3.其他重要的spring注解</h2><p><strong>@EnableConfigurationProperties(ChatGPTSDKConfigProperties.class)</strong></p>
<p>使用@<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=ConfigurationProperties&spm=1001.2101.3001.7020">ConfigurationProperties</a>的时候，把配置类的属性与yml配置文件绑定起来的时候，还需要加上@Component注解才能绑定并注入IOC容器中，若不加上@Component，则会无效</p>
<p><strong>@ConfigurationProperties(prefix &#x3D; “chatgpt.sdk.config”, ignoreInvalidFields &#x3D; true)</strong></p>
<p>@<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=EnableConfigurationProperties&spm=1001.2101.3001.7020">EnableConfigurationProperties</a>的作用：则是将让使用了 @ConfigurationProperties 注解的配置类生效,将该类注入到 IOC 容器中,交由 IOC 容器进行管理，此时则不用再配置类上加上@Component。</p>
<p><img data-src="https://yeb-1300251269.cos.ap-guangzhou.myqcloud.com/mytypra/image-20231219211014067.png" alt="image-20231219211014067" style="zoom:50%;" /><img data-src="https://yeb-1300251269.cos.ap-guangzhou.myqcloud.com/mytypra/image-20231219211035779-171353840106325.png" alt="image-20231219211035779" style="zoom: 50%;" /></p>
<p>这里@Bean的方法参数需要bean实例化，所以使用了@EnableConfigurationProperties实例化ChatGPTSDKConfigProperties为bean</p>
<p><strong>@EnableAsync</strong>（项目中已经删除）</p>
<p>@EnableAsync是一个Spring注解，用于启用异步方法的支持。当你在Spring应用程序中使用异步方法时，可以使用@EnableAsync注解来开启异步方法的支持。</p>
<p>使用@EnableAsync注解的步骤如下：</p>
<ol>
<li>在你的Spring配置类上添加@EnableAsync注解。例如：</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@EnableAsync</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AppConfig</span> &#123;</span><br><span class="line">    <span class="comment">// 配置其他的Bean</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>在你的异步方法上添加@Async注解。例如：</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyService</span> &#123;</span><br><span class="line">    <span class="meta">@Async</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">asyncMethod</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// 异步执行的代码</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>在调用异步方法时，Spring会自动创建一个线程来执行该方法，并立即返回一个Future对象，你可以使用该对象来获取异步方法的结果。</li>
</ol>
<p>@EnableAsync注解的作用是告诉Spring容器启用异步方法的支持。当你在应用程序中使用@Async注解时，Spring会自动创建一个线程池来执行异步方法。这样，你就可以在应用程序中使用异步方法来提高性能和并发性。</p>
<p>需要注意的是，为了使@EnableAsync注解生效，你需要确保在Spring配置类中配置了一个TaskExecutor bean。你可以使用@EnableAsync注解的proxyTargetClass属性来指定是否使用CGLIB代理，默认为false。如果你的目标类没有实现接口，你需要将proxyTargetClass属性设置为true。</p>
<p>总结起来，@EnableAsync注解的作用是启用Spring应用程序中异步方法的支持，使你能够在应用程序中使用@Async注解来创建异步方法。</p>
<h2 id="4-stream流设置bean"><a href="#4-stream流设置bean" class="headerlink" title="4.stream流设置bean"></a>4.stream流设置bean</h2><img data-src="https://yeb-1300251269.cos.ap-guangzhou.myqcloud.com/mytypra/image-20231221111310934.png" alt="image-20231221111310934" style="zoom:80%;" />

<h2 id="5-Unable-to-find-a-SpringBootConfiguration"><a href="#5-Unable-to-find-a-SpringBootConfiguration" class="headerlink" title="5.Unable to find a @SpringBootConfiguration"></a>5.Unable to find a @SpringBootConfiguration</h2><p>Unable to find a @SpringBootConfiguration, you need to use @ContextConfiguration</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/wwwwwww31311/article/details/115461920">https://blog.csdn.net/wwwwwww31311/article/details/115461920</a></p>
<p>该测试类在测试包test下的包名和类路径java下的包名不一致导致的，修改包名一致即可</p>
<h2 id="6-Module-was-compiled-with-an-incompatible-version-of-Kotlin"><a href="#6-Module-was-compiled-with-an-incompatible-version-of-Kotlin" class="headerlink" title="6.Module was compiled with an incompatible version of Kotlin"></a>6.Module was compiled with an incompatible version of Kotlin</h2><p>Module was compiled with an incompatible version of Kotlin.The binary version of its metadata is 1.6.0,expected version is 1.1.16.</p>
<img data-src="https://yeb-1300251269.cos.ap-guangzhou.myqcloud.com/mytypra/825a4635c9544a25a9e1caf59c5653ff-171353880614831.png" alt="img" style="zoom: 50%;" />

<h2 id="7-spring设置消息头"><a href="#7-spring设置消息头" class="headerlink" title="7.spring设置消息头"></a>7.spring设置消息头</h2><p>@GetMapping(produces &#x3D; “text&#x2F;plain;charset&#x3D;utf-8”)  </p>
<p>@PostMapping(produces &#x3D; “application&#x2F;xml; charset&#x3D;UTF-8”)</p>
<p>text&#x2F;html，application&#x2F;json等，其中text代表介质，html代表格式</p>
<p>RequestMapping 中produces 和 consumes</p>
<p>HTTP协议Header中的两个东西 ContentType 和Accept。</p>
<p>ContentType： 告诉服务器当前发送的数据是什么格式consumes<br> Accept ：     用来告诉服务器，客户端能认识哪些格式,最好返回这些格式produces </p>
<p>produces属性的功能</p>
<p>功能1：当请求头中Accept的value与produces()配置的属性匹配上，则进行映射，否则返回客户端HTTP 406（Not Acceptable）响应，或415 unsupported mediaType</p>
<p>功能2：默认会把produces中配置的内容写到响应头的Content-Type中去</p>
<p>当不配置produces()属性的时候，会根据Accept请求头来输出响应头的Content-Type;当配置produces()属性的时候，需要Accept与配置的属性兼容，否则会抛出406或415异常;当配置produces()属性的时候，如果未设置Accept请求头，那么默认就是*&#x2F;*，会根据produces属性来输出响应头的Content-Type</p>
<h2 id="8-规则引擎"><a href="#8-规则引擎" class="headerlink" title="8.规则引擎"></a>8.规则引擎</h2><p>策略，工厂</p>
<h2 id="9-防腐设计"><a href="#9-防腐设计" class="headerlink" title="9.防腐设计"></a>9.防腐设计</h2><p>infrastructure层引入domain层，domain层不引入infrastructure层，可以使得infrastructure层的持久化对象不对domain层暴露，也就说domain层不能直接使用po对象，同时infrastructure层通过依赖倒置的方式实现它的接口（domain层IXXXRepository接口，infrastructure层实现这个接口）</p>
<p>entity层基本和po层是对应的，entity可以对类型和字段进行筛选，主要是为了防腐设计。</p>
<p>aggregate：带有集合</p>
<p>entity：普通类型</p>
<p>valobj：带有枚举值</p>
<h2 id="10-支付流程"><a href="#10-支付流程" class="headerlink" title="10.支付流程"></a>10.支付流程</h2><img data-src="https://yeb-1300251269.cos.ap-guangzhou.myqcloud.com/mytypra/image-20240327095850906.png" alt="image-20240327095850906" style="zoom:80%;" />

<p>最核心的就是用户选择商品下单，之后生成一个支付URL，用户扫码支付。再接收到支付成功回调后，把用户购买的订单发货【额度充值】</p>
<ol>
<li>用户订单创建成功，但创建支付单 HTTP 超时失败。</li>
<li>支付回调时，系统宕机或者本身服务出问题。</li>
<li>支付成功后发送MQ消息，消息丢失，用户支付掉单。</li>
<li>长时间未支付，超时订单。</li>
<li>针对1~4提到异常流程，一条支付链路就会被扩展为现在的样子，在各个流程中需要穿插进入异常补偿流程。</li>
<li>用户下单，但可能存在之前下的<strong>残单</strong>，那么就要对应给予补充的流程后，再返回回去。</li>
<li>支付回调，仍然可能有异常。所以要有掉单补偿和发货补偿。两条任务处理。</li>
</ol>
<p>”支付流程相关查询有效的未支付订单，如果存在直接返回微信支付。“这里的未支付订单指同一个用户，如果之前有订单未支付，那么该用户不能继续下单。</p>
<p>未支付订单的处理方法</p>
<p>1.在用户下一次下单时提示有之前的订单</p>
<p>2.第三方签约平台会在支付后，每个一段时间发送回调通知，直到通知被回复。</p>
<p>3.自己后端开启定时任务，遍历数据库中的</p>
<h2 id="11-蓝兔支付api"><a href="#11-蓝兔支付api" class="headerlink" title="11.蓝兔支付api"></a>11.蓝兔支付api</h2><p><a target="_blank" rel="noopener" href="https://www.ltzf.cn/">https://www.ltzf.cn/</a></p>
<p><img data-src="https://yeb-1300251269.cos.ap-guangzhou.myqcloud.com/mytypra/image-20240419233043087.png" alt="image-20240419233043087" style="zoom:80%;" /><img data-src="https://yeb-1300251269.cos.ap-guangzhou.myqcloud.com/mytypra/image-20240419232946232.png" alt="image-20240419232946232" style="zoom:80%;" /></p>
<p>第三方签约平台会在支付后，每个一段时间发送回调通知，直到通知被回复。</p>
<p>回调地址</p>
<p>回调地址在生成支付链接时就已经确定，且无法修改</p>
<h2 id="12-注册"><a href="#12-注册" class="headerlink" title="12.注册"></a>12.注册</h2><p>如果账户是第一次登录，则为用户添加一个额度为5次的账号</p>
<p>测试步骤</p>
<img data-src="https://yeb-1300251269.cos.ap-guangzhou.myqcloud.com/mytypra/image-20240327160708350.png" alt="image-20240327160708350" style="zoom: 67%;" />

<p>记得修改商户管理里面的白名单</p>
<p>账号页面的会话效果为30（改为60）分钟，主要与token的过期时间有关。</p>
<h1 id="三-部署与维护"><a href="#三-部署与维护" class="headerlink" title="三.部署与维护"></a>三.部署与维护</h1><h2 id="1-docker部署后端"><a href="#1-docker部署后端" class="headerlink" title="1.docker部署后端"></a>1.docker部署后端</h2><p>1.1docker安装nginx</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">/**http版本*/</span><br><span class="line">docker run \</span><br><span class="line">--restart always \</span><br><span class="line">--name Nginx \</span><br><span class="line">-d \</span><br><span class="line">-v /data/nginx/html:/usr/share/nginx/html \</span><br><span class="line">-v /data/nginx/conf/nginx.conf:/etc/nginx/nginx.conf \</span><br><span class="line">-v /data/nginx/conf/conf.d:/etc/nginx/conf.d \</span><br><span class="line">-p 80:80 \</span><br><span class="line">nginx</span><br></pre></td></tr></table></figure>

<p>上面代码是nginx在docker容器中的启动命令</p>
<p>其中-v &#x2F;data&#x2F;nginx&#x2F;html:&#x2F;usr&#x2F;share&#x2F;nginx&#x2F;html\表示将系统中的&#x2F;data&#x2F;nginx&#x2F;html文件与容器中的&#x2F;usr&#x2F;share&#x2F;nginx&#x2F;html的文件进行映射，这样就只需要修改系统中的文件完成对容器内nginx的配置。</p>
<p>1.2docker与idea整合</p>
<ol>
<li><p>需要开放2375端口。由于目前没有使用ca的方式对端口进行限制，所以每次用完之后需要及时关闭该窗口，避免病毒入侵。</p>
</li>
<li><p>整合之后，idea中编写的项目就可以自动部署到容器中，实现在服务器上运行。不需要每次都打包，上传到服务器。</p>
</li>
<li><p>打包项目-&gt;打包上传镜像-&gt;运行容器<img data-src="https://yeb-1300251269.cos.ap-guangzhou.myqcloud.com/mytypra/image-20231126003120076-171354296160836.png" alt="image-20231126003120076"></p>
</li>
</ol>
<img data-src="https://yeb-1300251269.cos.ap-guangzhou.myqcloud.com/mytypra/image-20231126003142948-171354296160938.png" alt="image-20231126003142948" style="zoom: 50%;" />

<p>​	4.之后每次发布到服务器都要重新打包项目和镜像，同时删除服务器中的镜像。</p>
<p>2.nginx+https</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">docker run \</span><br><span class="line">--restart always \</span><br><span class="line">--name Nginx \</span><br><span class="line">--privileged=true \</span><br><span class="line">-p 443:443 -p 80:80 \</span><br><span class="line">-d \</span><br><span class="line">-v /data/nginx/logs:/var/log/nginx \</span><br><span class="line">-v /data/nginx/html:/usr/share/nginx/html \</span><br><span class="line">-v /data/nginx/conf/nginx.conf:/etc/nginx/nginx.conf \</span><br><span class="line">-v /data/nginx/conf/conf.d:/etc/nginx/conf.d \</span><br><span class="line">-v /data/nginx/ssl:/etc/nginx/ssl/ \</span><br><span class="line">nginx</span><br><span class="line"></span><br><span class="line">yeb-study.top证书文件</span><br><span class="line">scs1702182163235_yeb-study.top_server.crt</span><br><span class="line">yeb-study.top私钥</span><br><span class="line">scs1702182163235_yeb-study.top_server.key</span><br><span class="line"></span><br><span class="line">scs1702211613118_mygpt.yeb-study.top_server.crt</span><br><span class="line"></span><br><span class="line">scs1702211613118_mygpt.yeb-study.top_server.key</span><br><span class="line"></span><br><span class="line">nginx.exe目录下</span><br><span class="line">start nginx</span><br><span class="line">nginx.exe -s stop</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">listen       80;</span><br><span class="line">server_name  localhost;</span><br><span class="line"></span><br><span class="line"># 首页</span><br><span class="line">index index.html;</span><br><span class="line"></span><br><span class="line">location / &#123;</span><br><span class="line">    root   /usr/share/nginx/html;</span><br><span class="line">    index  index.html index.htm;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">location /api/ &#123;</span><br><span class="line">    auth_request /auth;</span><br><span class="line">    # 鉴权通过后的处理方式</span><br><span class="line">    proxy_pass http://localhost:8080/success;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">location = /auth &#123;</span><br><span class="line">    # 发送子请求到HTTP服务，验证客户端的凭据，返回响应码</span><br><span class="line">    internal;</span><br><span class="line">    # 设置参数</span><br><span class="line">    set $query &#x27;&#x27;;</span><br><span class="line">    if ($request_uri ~* &quot;[^\?]+\?(.*)$&quot;) &#123;</span><br><span class="line">        set $query $1;</span><br><span class="line">    &#125;</span><br><span class="line">    # 验证成功，返回200 OK</span><br><span class="line">    proxy_pass http://localhost:8080/verify?$query;</span><br><span class="line">    # 发送原始请求</span><br><span class="line">    proxy_pass_request_body off;</span><br><span class="line">    # 清空 Content-Type</span><br><span class="line">    proxy_set_header Content-Type &quot;&quot;;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">	listen       <span class="number">80</span>;</span><br><span class="line">	server_name  mygpt.yeb-study.top;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">301</span> https:<span class="comment">//$server_name$request_uri;</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">server &#123;</span><br><span class="line">    listen       <span class="number">443</span> ssl;</span><br><span class="line">    server_name  mygpt.yeb-study.top;</span><br><span class="line"></span><br><span class="line">    # 首页</span><br><span class="line">    index index.html;</span><br><span class="line"></span><br><span class="line">    ssl_certificate      /etc/nginx/ssl/scs1702211613118_mygpt.yeb-study.top_server.crt;</span><br><span class="line">    ssl_certificate_key  /etc/nginx/ssl/scs1702211613118_mygpt.yeb-study.top_server.key;</span><br><span class="line"></span><br><span class="line">    ssl_session_cache    shared:SSL:1m;</span><br><span class="line">    ssl_session_timeout  5m;</span><br><span class="line"></span><br><span class="line">    ssl_ciphers  HIGH:!aNULL:!MD5;</span><br><span class="line">    ssl_prefer_server_ciphers  on;</span><br><span class="line"></span><br><span class="line">	location / &#123;</span><br><span class="line">		proxy_set_header   Host              $host;</span><br><span class="line">		proxy_pass http:<span class="comment">//mygpt.yeb-study.top:3000; </span></span><br><span class="line">    &#125;</span><br><span class="line">	location /api/&#123;</span><br><span class="line">    		proxy_set_header Host $host;</span><br><span class="line">        	proxy_pass      http:<span class="comment">//mygpt.yeb-study.top:8091;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    error_page <span class="number">404</span> /<span class="number">404.</span>html;</span><br><span class="line">        location = /40x.html &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    error_page   <span class="number">500</span> <span class="number">502</span> <span class="number">503</span> <span class="number">504</span>  /50x.html;</span><br><span class="line">    location = /50x.html &#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>https简介</p>
<p>免费ssl证书配置网站https</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/studytime/p/12871050.html">https://www.cnblogs.com/studytime/p/12871050.html</a></p>
<h2 id="3-微信公众号对接"><a href="#3-微信公众号对接" class="headerlink" title="3.微信公众号对接"></a>3.微信公众号对接</h2><p>微信公众号对接</p>
<p><img data-src="https://yeb-1300251269.cos.ap-guangzhou.myqcloud.com/mytypra/image-20231213155857493-171354300616042.png" alt="image-20231213155857493"></p>
<p><img data-src="https://yeb-1300251269.cos.ap-guangzhou.myqcloud.com/mytypra/image-20231213165042407-171354300616044.png" alt="image-20231213165042407"></p>
<p>项目需要实现两个接口：微信验证交换签名接口，微信应答接口</p>
<p>项目测试：需要电脑开启natapp，公众号开启对接</p>
<p>微信应答时间过长。用户发送问题给公众号，公众号请求服务端获取应答。但实际上请求chagpt的时间会超过3s，而公众对超过3s的请求会丢失，无法给出应答。</p>
<h2 id="4-前端部署"><a href="#4-前端部署" class="headerlink" title="4.前端部署"></a>4.前端部署</h2><p>在服务器中如果使用dev运行前端项目，那么客户端请求前端时会加载编译所有的模块，响应时间很长，有时会报timeout错误</p>
<p>npm dev(开发) -&gt; npm build -&gt; npm start（部署）</p>
<p>npm run dev、npm run build和npm run start是npm命令中常用的三个命令，它们的区别如下：</p>
<ol>
<li>npm run dev：该命令通常用于开发环境，它会启动一个开发服务器，并监听文件的变化。当文件发生变化时，开发服务器会自动重新编译代码并刷新页面，方便开发人员实时查看修改的效果。</li>
<li>npm run build：该命令通常用于生产环境，它会将项目中的源代码进行打包、压缩和优化，生成用于部署的静态文件。打包后的文件通常包括HTML、CSS、JavaScript等资源文件，可以直接部署到服务器上供用户访问。</li>
<li>npm run start：该命令通常用于生产环境，它会启动一个服务器，将打包后的静态文件提供给用户访问。与npm run dev不同的是，npm run start不会监听文件的变化，也不会重新编译代码，适用于已经打包好的项目部署。</li>
</ol>
<p>总结来说，npm run dev用于开发环境，提供实时编译和刷新页面的功能；npm run build用于生产环境，将源代码打包成静态文件；npm run start用于生产环境，启动服务器提供静态文件的访问。</p>
<p>docker日志，可以通过portainer查看容器运行的日志信息。实际上并不需要win下载docker，直接把源文件放linux服务器即可</p>
<p>docker空间爆满<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_40432886/article/details/132323036">https://blog.csdn.net/qq_40432886/article/details/132323036</a></p>
<p>注：下次删除overlay文件时要先进行备份，或者使用docker prune自带的空间清理</p>
<p> 2275086</p>
<p>mixcontent</p>
<p>用https访问nginx，但是前端请求后端接口时，使用http协议，浏览器就会报错</p>
<p>解决方法，把前端请求全部换为https，然后nginx反向代理http:8091</p>
<h2 id="5-dokcer导致空间不足"><a href="#5-dokcer导致空间不足" class="headerlink" title="5.dokcer导致空间不足"></a>5.dokcer导致空间不足</h2><p>由于docker空间不足，删除了overlay文件，导致整个docker的容器不可用，现在需要重新安装docker，顺便重新总结一下部署流程</p>
<p>注：下次删除overlay文件时要先进行备份，或者使用docker prune自带的空间清理</p>
<p>5.1安装docker</p>
<p><a href="file:///E:/study/javawebSys/springSys/docker/资料(1)/Docker课件/docker1-基础.pdf">docker1-基础.pdf</a></p>
<p><a href="file:///E:/study/javawebSys/springSys/docker/资料(1)/Docker课件/docker6-图形化工具.pdf">docker6-图形化工具.pdf</a></p>
<p>5.2docker常见容器的安装(mysql，nginx，redis)</p>
<p><a href="file:///E:/study/javawebSys/springSys/docker/资料(1)/Docker课件/docker2-安装.pdf">docker2-安装.pdf</a></p>
<p>nginx的启动命令参考上文</p>
<p>5.3项目容器部署</p>
<p>1.后端：使用idea连接docker，先开放docker端口（危险，用完即关），然后构建镜像，最后在服务器上运行下面指令。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">docker run \</span><br><span class="line">--restart always \</span><br><span class="line">--name chatgpt-data-app \</span><br><span class="line">-d \</span><br><span class="line">-v ./log:/data/log \</span><br><span class="line">-p 8091:8091 \</span><br><span class="line">--log-driver=json-file \</span><br><span class="line">yeb/chatgpt-data-app:latest</span><br></pre></td></tr></table></figure>

<p>（理论上也可以用前端部署的方法）</p>
<p>2.前端：把前端代码复制到linux上，然后运行build.sh和start.sh，build需要Dockerfile文件。</p>
<p>注：端口开放除了系统防火墙外，还有控制台的安全组</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_42112846/article/details/103854132?spm=1001.2101.3001.6650.1&utm_medium=distribute.pc_relevant.none-task-blog-2~default~CTRLIST~Rate-1-103854132-blog-109218596.235%5Ev43%5Epc_blog_bottom_relevance_base9&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~CTRLIST~Rate-1-103854132-blog-109218596.235%5Ev43%5Epc_blog_bottom_relevance_base9&utm_relevant_index=2">https://blog.csdn.net/qq_42112846/article/details/103854132?spm=1001.2101.3001.6650.1&amp;utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7ECTRLIST%7ERate-1-103854132-blog-109218596.235%5Ev43%5Epc_blog_bottom_relevance_base9&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7ECTRLIST%7ERate-1-103854132-blog-109218596.235%5Ev43%5Epc_blog_bottom_relevance_base9&amp;utm_relevant_index=2</a></p>
<h2 id="Mysql数据库时间与系统时间不一致问题"><a href="#Mysql数据库时间与系统时间不一致问题" class="headerlink" title="Mysql数据库时间与系统时间不一致问题"></a>Mysql数据库时间与系统时间不一致问题</h2><p>1.通过sql语句，查看系统时区，修改时区来校对时间</p>
<p>– 第一步：查看系统时区</p>
<p>show variables like ‘%time_zone%’;</p>
<p>– 第二步：修改时区，并生效</p>
<p>– 修改系统时区</p>
<p>set global time_zone &#x3D; ‘+08:00’;</p>
<p>– 修改当前会话时区</p>
<p>set time_zone &#x3D; ‘+8:00’;</p>
<h2 id="项目展示"><a href="#项目展示" class="headerlink" title="项目展示"></a>项目展示</h2><img data-src="https://yeb-1300251269.cos.ap-guangzhou.myqcloud.com/mytypra/image-20240402152023632.png" alt="image-20240402152023632" style="zoom:80%;" />

<img data-src="https://yeb-1300251269.cos.ap-guangzhou.myqcloud.com/mytypra/image-20240402152113245.png" alt="image-20240402152113245" style="zoom:80%;" />

<img data-src="https://yeb-1300251269.cos.ap-guangzhou.myqcloud.com/mytypra/image-20240402152340491.png" alt="image-20240402152340491" style="zoom:80%;" />

<img data-src="https://yeb-1300251269.cos.ap-guangzhou.myqcloud.com/mytypra/image-20240402152842095.png" alt="image-20240402152842095" style="zoom:50%;" />

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://yeb-wu.github.io/posts/91c5.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="yebin">
      <meta itemprop="description" content="Java攻城狮">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="yeb-blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/posts/91c5.html" class="post-title-link" itemprop="url">2023-10-01-分布式</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-10-01 14:26:18" itemprop="dateCreated datePublished" datetime="2023-10-01T14:26:18+08:00">2023-10-01</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-03-21 17:37:32" itemprop="dateModified" datetime="2024-03-21T17:37:32+08:00">2024-03-21</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Java-Web/" itemprop="url" rel="index"><span itemprop="name">Java Web</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>9.8k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>9 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="分布式"><a href="#分布式" class="headerlink" title="分布式"></a>分布式</h1><p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1VW4y1o7n5/?spm_id_from=333.337.search-card.all.click&vd_source=3b3520ea5845a2bda781e688011626d9">https://www.bilibili.com/video/BV1VW4y1o7n5/?spm_id_from=333.337.search-card.all.click&amp;vd_source=3b3520ea5845a2bda781e688011626d9</a></p>
<p><a target="_blank" rel="noopener" href="http://icyfenix.cn/changelog/">http://icyfenix.cn/changelog/</a></p>
<h2 id="cap和base"><a href="#cap和base" class="headerlink" title="cap和base"></a>cap和base</h2><p><a target="_blank" rel="noopener" href="https://baijiahao.baidu.com/s?id=1770092408059967099&wfr=spider&for=pc">https://baijiahao.baidu.com/s?id=1770092408059967099&amp;wfr=spider&amp;for=pc</a></p>
<h3 id="一、CAP定理"><a href="#一、CAP定理" class="headerlink" title="一、CAP定理"></a><strong>一、CAP定理</strong></h3><p>在一个分布式系统中（指互相连接并共享数据的节点集合）中，当涉及到读写操作时，只能保证一致性（Consistence）、可用性(Availability）、分区容错性（Partition Tolerance）三者中的两个，另外一个必须被牺牲。</p>
<p><strong>一致性(Consistence)</strong> , 这个是针对数据来说的，比如数据库MySQL中的数据，一个分布式系统中，某个节点修改了一个数据，那么之后其他所有节点读取这条数据的时候，得到的一定是最新的数据。</p>
<p>**可用性(Availability)**，分布式系统中某些节点挂掉了，但是不会影响整体的业务，比如 C 这个微服务，有10个实例组成一个集群，其中5个挂了，另外5个正常，这种情况下整个系统还是可用的，不会因为挂了那5个，导致系统整体不可用。</p>
<p>**分区容错性(Partition Tolerance)**，分布式系统出现网络分区的时候，仍然能够对外提供服务。</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/posts/91c5.html#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://yeb-wu.github.io/posts/e6af.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="yebin">
      <meta itemprop="description" content="Java攻城狮">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="yeb-blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/posts/e6af.html" class="post-title-link" itemprop="url">2023-07-06-Lottery抽奖系统</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-07-06 14:27:55" itemprop="dateCreated datePublished" datetime="2023-07-06T14:27:55+08:00">2023-07-06</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-03-21 17:37:10" itemprop="dateModified" datetime="2024-03-21T17:37:10+08:00">2024-03-21</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E9%A1%B9%E7%9B%AE%E5%AE%9E%E6%88%98/" itemprop="url" rel="index"><span itemprop="name">项目实战</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>20k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>19 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="项目2-0"><a href="#项目2-0" class="headerlink" title="项目2.0"></a>项目2.0</h1><h2 id="一-lottery"><a href="#一-lottery" class="headerlink" title="一.lottery"></a>一.lottery</h2>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/posts/e6af.html#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://yeb-wu.github.io/posts/8980.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="yebin">
      <meta itemprop="description" content="Java攻城狮">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="yeb-blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/posts/8980.html" class="post-title-link" itemprop="url">2023-07-04-计算机网络2</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-07-04 14:26:42" itemprop="dateCreated datePublished" datetime="2023-07-04T14:26:42+08:00">2023-07-04</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-03-21 17:35:50" itemprop="dateModified" datetime="2024-03-21T17:35:50+08:00">2024-03-21</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/" itemprop="url" rel="index"><span itemprop="name">计算机基础</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>8.7k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>8 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="计网（小林coding）"><a href="#计网（小林coding）" class="headerlink" title="计网（小林coding）"></a>计网（小林coding）</h1><h2 id="1-当键入网址后，到网页显示，其间发生了什么"><a href="#1-当键入网址后，到网页显示，其间发生了什么" class="headerlink" title="1.当键入网址后，到网页显示，其间发生了什么"></a>1.当键入网址后，到网页显示，其间发生了什么</h2><p>http</p>
<p>首先浏览器做的第一步工作就是要对 <code>URL</code> 进行解析，从而生成发送给 <code>Web</code> 服务器的请求信息。</p>
<p>dns</p>
<p>由于大多数网址都使用的是域名，因此在发送之前需要查询服务器域名对应的 IP 地址。</p>
<p>协议栈</p>
<p>通过 DNS 获取到 IP 后，浏览器委托协议栈进行http请求消息的传输工作。</p>
<p>tcp</p>
<p>HTTP是基于TCP的，所以在协议栈会使用TCP协议，在HTTP请求中添加TCP报文头部。TCP是面向连接的，所以在开始发送数据之前，需要通过三次握手来建立连接，然后才能发送数据。</p>
<p>ip</p>
<p>TCP报文中在添加IP头部，用于在网络层中寻找目的地址的网络。</p>
<p>mac</p>
<p>然后在IP报文中添加MAC头部，用于在以太网中传输数据。</p>
<p>最后将这个封装了TCP头部，IP头部，和MAC头部的HTTPx消息交由</p>
<p>网卡发送出去，中间会使用路由器通过ip地址转发，使用交换机通过mac地址转发，最后到达服务器设备。</p>
<p>服务器的网卡收到数据包后，通过层层拆包，最后在TCP 头部端口号中发现某个HTTP 的服务器正在监听这个端口号</p>
<p>于是交由这个HTTP进程处理，发现这个请求是要访问一个页面，于是就把这个网页封装在 HTTP 响应报文里。</p>
<p>http套上tcp，ip，mac头部，然后发送出去。客户端收到该报文后，解析出http响应报文后，浏览器渲染页面并显示。</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/posts/8980.html#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://yeb-wu.github.io/posts/88c0.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="yebin">
      <meta itemprop="description" content="Java攻城狮">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="yeb-blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/posts/88c0.html" class="post-title-link" itemprop="url">2023-07-04-计算机网络1</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-07-04 14:26:35" itemprop="dateCreated datePublished" datetime="2023-07-04T14:26:35+08:00">2023-07-04</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-03-21 17:35:36" itemprop="dateModified" datetime="2024-03-21T17:35:36+08:00">2024-03-21</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/" itemprop="url" rel="index"><span itemprop="name">计算机基础</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>8.4k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>8 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="TCP-三次握手与四次挥手面试题"><a href="#TCP-三次握手与四次挥手面试题" class="headerlink" title="TCP 三次握手与四次挥手面试题"></a>TCP 三次握手与四次挥手面试题</h2><h3 id="TCP-UDP-基础知识"><a href="#TCP-UDP-基础知识" class="headerlink" title="TCP&#x2F;UDP 基础知识"></a>TCP&#x2F;UDP 基础知识</h3><h4 id="TCP-头格式"><a href="#TCP-头格式" class="headerlink" title="TCP 头格式"></a>TCP 头格式</h4><p>原端口号,目标端口号,<strong>序列号(seq)，确认应答号，窗口大小，控制位</strong>(ACK,RST,SYN,FIN)，首部长度，校验和</p>
<p>序列号：在建立连接时由计算机生成的<strong>随机数</strong>作为其初始值，通过 SYN 包传给接收端主机，每发送一次数据，就「累加」一次该「数据字节数」的大小。<strong>用来解决网络包乱序问题。</strong></p>
<p>确认应答号：指下一次「期望」收到的数据的序列号，发送端收到这个确认应答以后可以认为在这个序号以前的数据都已经被正常接收。<strong>用来解决丢包的问题。</strong></p>
<ul>
<li><em>ACK</em>：该位为 <code>1</code> 时，「确认应答」的字段变为有效，TCP 规定除了最初建立连接时的 <code>SYN</code> 包之外该位必须设置为 <code>1</code> 。</li>
<li><em>RST</em>：该位为 <code>1</code> 时，表示 TCP 连接中出现异常必须强制断开连接。</li>
<li><em>SYN</em>：该位为 <code>1</code> 时，表示希望建立连接，并在其「序列号」的字段进行序列号初始值的设定。</li>
<li><em>FIN</em>：该位为 <code>1</code> 时，表示今后不会再有数据发送，希望断开连接。当通信结束希望断开连接时，通信双方的主机之间就可以相互交换 <code>FIN</code> 位为 1 的 TCP 段。</li>
</ul>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/posts/88c0.html#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://yeb-wu.github.io/posts/71e8.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="yebin">
      <meta itemprop="description" content="Java攻城狮">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="yeb-blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/posts/71e8.html" class="post-title-link" itemprop="url">2023-07-04-数据库(MySQL)</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-07-04 14:26:25" itemprop="dateCreated datePublished" datetime="2023-07-04T14:26:25+08:00">2023-07-04</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-03-21 17:36:42" itemprop="dateModified" datetime="2024-03-21T17:36:42+08:00">2024-03-21</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/" itemprop="url" rel="index"><span itemprop="name">计算机基础</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>28k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>25 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="SQL语句的执行流程"><a href="#SQL语句的执行流程" class="headerlink" title="SQL语句的执行流程"></a>SQL语句的执行流程</h2><img data-src="https://yeb-1300251269.cos.ap-guangzhou.myqcloud.com/mytypra/image-20230403143442502.png" alt="image-20230403143442502" style="zoom:80%;" />

<p>查询语句的执行流程如下：权限校验（如果命中缓存）—&gt;查询缓存—&gt;分析器—&gt;优化器—-&gt;执行器—&gt;引擎</p>
<p>更新语句执行流程如下：权限校验—-&gt;分析器—&gt;优化器—-&gt;执行器—&gt;引擎—redo log(prepare 状态)—&gt;binlog—&gt;redo log(commit状态)</p>
<p>分析器：对sql语句进行词法分析和语法分析，分析 SQL 语句是来干嘛的</p>
<p>优化器：主要对sql语句的执行方式进行优化，比如如何选择索引，多表查询选哪个作为内嵌表。经历优化器后具体的执行计划就确定下来了。</p>
<p>执行器：根据执行计划调用引擎的接口，返回接口执行的结果</p>
<p>注：执行器负责控制语句的执行流程和计算工作，对应日志为binlog；储存引擎负责数据的储存和读取，对应日志为redo log。查询语句不会写入日志文件。</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/posts/71e8.html#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://yeb-wu.github.io/posts/8197.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="yebin">
      <meta itemprop="description" content="Java攻城狮">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="yeb-blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/posts/8197.html" class="post-title-link" itemprop="url">2023-06-30-设计模式</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-06-30 14:25:35" itemprop="dateCreated datePublished" datetime="2023-06-30T14:25:35+08:00">2023-06-30</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-03-21 17:35:09" itemprop="dateModified" datetime="2024-03-21T17:35:09+08:00">2024-03-21</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Java/" itemprop="url" rel="index"><span itemprop="name">Java</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>9k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>8 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="什么是设计模式？"><a href="#什么是设计模式？" class="headerlink" title="什么是设计模式？"></a>什么是设计模式？</h2><p> 设计模式（Design pattern）代表了最佳的实践，通常被有经验的⾯向对象 的软件开发⼈员所采⽤。设计模式是软件开发⼈员在软件开发过程中⾯临 的⼀般问题的解决⽅案。这些解决⽅案是众多软件开发⼈员经过相当⻓的 ⼀段时间的试验和错误总结出来的</p>
<p>设计模式是⼀套被反复使⽤的、多数⼈知晓的、经过分类编⽬的、代码设 计经验的总结。使⽤设计模式是为了重⽤代码、让代码更容易被他⼈理解、保证代码可靠性。 毫⽆疑问，设计模式于⼰于他⼈于系统都是多赢 的，设计模式使代码编制真正⼯程化，设计模式是软件⼯程的基⽯，如同 ⼤厦的⼀块块砖⽯⼀样。项⽬中合理地运⽤设计模式可以完美地解决很多 问题，每种模式在现实中都有相应的原理来与之对应，每种模式都描述了 ⼀个在我们周围不断重复发⽣的问题，以及该问题的核⼼解决⽅案，这也 是设计模式能被⼴泛应⽤的原因。</p>
<img data-src="https://yeb-1300251269.cos.ap-guangzhou.myqcloud.com/mytypra/image-20230418102009936.png" alt="image-20230418102009936" style="zoom:80%;" />
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/posts/8197.html#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://yeb-wu.github.io/posts/7cd2.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="yebin">
      <meta itemprop="description" content="Java攻城狮">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="yeb-blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/posts/7cd2.html" class="post-title-link" itemprop="url">2023-06-20-Java多线程(JUC)</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-06-20 14:25:21" itemprop="dateCreated datePublished" datetime="2023-06-20T14:25:21+08:00">2023-06-20</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-03-21 17:34:55" itemprop="dateModified" datetime="2024-03-21T17:34:55+08:00">2024-03-21</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Java/" itemprop="url" rel="index"><span itemprop="name">Java</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>29k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>27 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="一-JMM内存模型"><a href="#一-JMM内存模型" class="headerlink" title="一.JMM内存模型"></a>一.JMM内存模型</h2><p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s?__biz=MzU0OTE4MzYzMw==&mid=2247533850&idx=4&sn=7477c8346a738e9a234c3b85f1cd0bc4&chksm=fbb1cce4ccc645f238e66ee5d45c9aa85c51f47987a8719e035b51ec8d49c75457b18a1dfae3&scene=27">https://mp.weixin.qq.com/s?__biz=MzU0OTE4MzYzMw==&amp;mid=2247533850&amp;idx=4&amp;sn=7477c8346a738e9a234c3b85f1cd0bc4&amp;chksm=fbb1cce4ccc645f238e66ee5d45c9aa85c51f47987a8719e035b51ec8d49c75457b18a1dfae3&amp;scene=27</a></p>
<p><a target="_blank" rel="noopener" href="https://javaguide.cn/java/concurrent/jmm.html">https://javaguide.cn/java/concurrent/jmm.html</a></p>
<h4 id="JMM模型中多线程编程的两个问题"><a href="#JMM模型中多线程编程的两个问题" class="headerlink" title="JMM模型中多线程编程的两个问题"></a>JMM模型中多线程编程的两个问题</h4><p>1.共享内存</p>
<p>在JMM中，规定了共享变量是存放在<code>主内存</code>中，然后每个线程都有自己的<code>工作内存</code>，至于什么时候写回到主内存是不可预知的，这就导致每个线程之间对共享变量的操作是封闭的，其他线程不可见的。</p>
<p>2.指令重排序</p>
<p>为了性能优化，JVM会在不改变<code>数据依赖性</code>的情况下，允许<code>编译器和处理器对指令序列进行重排序</code>，而有序性问题指的就是程序代码执行的顺序与程序员编写程序的顺序不一致，导致程序结果不正确的问题。</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/posts/7cd2.html#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="yebin"
      src="/images/avatar.png">
  <p class="site-author-name" itemprop="name">yebin</p>
  <div class="site-description" itemprop="description">Java攻城狮</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">26</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://gitee.com/yebbasbfa" title="GitHub → https:&#x2F;&#x2F;gitee.com&#x2F;yebbasbfa" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:1364767592@qq.com" title="E-Mail → mailto:1364767592@qq.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://leetcode.cn/u/yeb12/" title="leetcode → https:&#x2F;&#x2F;leetcode.cn&#x2F;u&#x2F;yeb12&#x2F;" rel="noopener" target="_blank"><i class="fab fa-stack-overflow fa-fw"></i>leetcode</a>
      </span>
  </div>



      </div>
        <div class="back-to-top motion-element">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">yebin</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
      <span class="post-meta-item-text">站点总字数：</span>
    <span title="站点总字数">273k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span class="post-meta-item-text">站点阅读时长 &asymp;</span>
    <span title="站点阅读时长">4:08</span>
</div>

<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<span><br></span>	

<span class="post-meta-item-icon">
      <i class="fa fa-user"></i>
</span>
<span>总访客&nbsp<span id="busuanzi_value_site_uv"></span>&nbsp人</span>
    <span class="post-meta-divider">|</span>
<span class="post-meta-item-icon">
      <i class="fa fa-eye"></i>
</span>
    <span>总访问量&nbsp<span id="busuanzi_value_site_pv"></span>&nbsp次</span>

<!-- 网站运行时间的设置 -->
<span id="timeDate">载入天数...</span>
<span id="times">载入时分秒...</span>
<script>
    var now = new Date();
    function createtime() {
        var grt= new Date("08/10/2023 12:00:00");//此处修改你的建站时间或者网站上线时间
        now.setTime(now.getTime()+250);
        days = (now - grt ) / 1000 / 60 / 60 / 24; dnum = Math.floor(days);
        hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum); hnum = Math.floor(hours);
        if(String(hnum).length ==1 ){hnum = "0" + hnum;} minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum);
        mnum = Math.floor(minutes); if(String(mnum).length ==1 ){mnum = "0" + mnum;}
        seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum);
        snum = Math.round(seconds); if(String(snum).length ==1 ){snum = "0" + snum;}
        document.getElementById("timeDate").innerHTML = "本站已安全运行 "+dnum+" 天 ";
        document.getElementById("times").innerHTML = hnum + " 小时 " + mnum + " 分 " + snum + " 秒";
    }
    setInterval("createtime()",250);
</script>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/lozad@1/dist/lozad.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/assets/hijiki.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"react":{"opacity":0.7},"log":false});</script></body>
</html>
